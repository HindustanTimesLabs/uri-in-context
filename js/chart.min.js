function calcHeight(a){return"sm"==a?y=200:y=400,y}function draw(a){var b={top:40,right:1,bottom:30,left:20},c=$("#month-chart").width()-b.left-b.right,d=calcHeight(breakpoint)-b.top-b.bottom,e=d3.scaleBand().range([0,c],.1),f=d3.scaleLinear().range([d,0]),g=d3.axisBottom().scale(e),h=d3.axisLeft().scale(f).ticks(5),i=d3.select("#month-chart").append("svg").attr("width",c+b.left+b.right).attr("height",d+b.top+b.bottom).append("g").attr("transform","translate("+b.left+","+b.top+")");d3.csv("data/months.csv",type,function(b,c){e.domain(c.map(function(a){return a.month})),i.append("g").attr("class","x axis").attr("transform","translate(0,"+d+")").call(g),f.domain([0,d3.max(c,function(b){return b[a]})]),i.append("g").attr("class","y axis").call(h).append("text").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text("Frequency");var j=i.selectAll(".bar").data(c);j.enter().append("rect").attr("class","bar").attr("x",function(a){return e(a.month)+4}).attr("width",e.bandwidth()-4).attr("y",function(b){return f(b[a])}).attr("height",function(b){return d-f(b[a])}).on("mouseover",function(b){$("#month-chart").append('<div class="chart-tip"></div>'),$(".chart-tip").append('<div class="title">'+b.month+"</div>"),$(".chart-tip").append('<div class="tip-item total"><div class="key">Total attacks</div><div class="value">'+b.attack+"</div></div>"),$(".chart-tip").append('<div class="tip-item subtitle total"><div class="key">Total killed</div><div class="value">'+b.tot+"</div></div>"),$(".chart-tip").append('<div class="tip-item"><div class="key">Militants</div><div class="value">'+b.mil+"</div></div>"),$(".chart-tip").append('<div class="tip-item"><div class="key">Indian security forces</div><div class="value">'+b.sec+"</div></div>"),$(".chart-tip").append('<div class="tip-item"><div class="key">Civilians</div><div class="value">'+b.civ+"</div></div>");var c=$(".chart-tip").height();$(".chart-tip").css({top:f(b[a])-c+10,left:e(b.month)-(e.bandwidth()-4)/2-20,width:4*e.bandwidth()})}).on("mouseout",function(){$(".chart-tip").remove()}),$(".x.axis text").each(function(a,b){var c=$(b).text(),d=c.slice(0,3);"sm"==breakpoint?$(b).text(d):$(b).text(c)})})}function type(a){return a.attack=+a.attack,a.civ=+a.civ,a.sec=+a.sec,a.mil=+a.mil,a.tot=+a.tot,a}draw("attack");
